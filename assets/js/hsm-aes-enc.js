var r;var t=0xdeadbeefcafe;var n=(t&16777215)==15715070;function b(r,t,i){if(r!=null)if("number"==typeof r)this.t(r,t,i);else if(t==null&&"string"!=typeof r)this.i(r,256);else this.i(r,t)}function F(){return new b(null)}function e(r,t,i,n,e,s){while(--s>=0){var h=t*this[r++]+i[n]+e;e=Math.floor(h/67108864);i[n++]=h&67108863}return e}function s(r,t,i,n,e,s){var h=t&32767,a=t>>15;while(--s>=0){var f=this[r]&32767;var u=this[r++]>>15;var v=a*f+u*h;f=h*f+((v&32767)<<15)+i[n]+(e&1073741823);e=(f>>>30)+(v>>>15)+a*u+(e>>>30);i[n++]=f&1073741823}return e}function h(r,t,i,n,e,s){var h=t&16383,a=t>>14;while(--s>=0){var f=this[r]&16383;var u=this[r++]>>14;var v=a*f+u*h;f=h*f+((v&16383)<<14)+i[n]+e;e=(f>>28)+(v>>14)+a*u;i[n++]=f&268435455}return e}if(n&&navigator.appName=="Microsoft Internet Explorer"){b.prototype.s=s;r=30}else if(n&&navigator.appName!="Netscape"){b.prototype.s=e;r=26}else{b.prototype.s=h;r=28}b.prototype.h=r;b.prototype.u=(1<<r)-1;b.prototype.v=1<<r;var a=52;b.prototype.o=Math.pow(2,a);b.prototype.l=a-r;b.prototype.p=2*r-a;var f="0123456789abcdefghijklmnopqrstuvwxyz";var u=new Array;var v,o;v="0".charCodeAt(0);for(o=0;o<=9;++o)u[v++]=o;v="a".charCodeAt(0);for(o=10;o<36;++o)u[v++]=o;v="A".charCodeAt(0);for(o=10;o<36;++o)u[v++]=o;function l(r){return f.charAt(r)}function c(r,t){var i=u[r.charCodeAt(t)];return i==null?-1:i}function w(r){for(var t=this.g-1;t>=0;--t)r[t]=this[t];r.g=this.g;r.A=this.A}function y(r){this.g=1;this.A=r<0?-1:0;if(r>0)this[0]=r;else if(r<-1)this[0]=r+this.v;else this.g=0}function p(r){var t=F();t.F(r);return t}function g(r,t){var i;if(t==16)i=4;else if(t==8)i=3;else if(t==256)i=8;else if(t==2)i=1;else if(t==32)i=5;else if(t==4)i=2;else{this.M(r,t);return}this.g=0;this.A=0;var n=r.length,e=false,s=0;while(--n>=0){var h=i==8?r[n]&255:c(r,n);if(h<0){if(r.charAt(n)=="-")e=true;continue}e=false;if(s==0)this[this.g++]=h;else if(s+i>this.h){this[this.g-1]|=(h&(1<<this.h-s)-1)<<s;this[this.g++]=h>>this.h-s}else this[this.g-1]|=h<<s;s+=i;if(s>=this.h)s-=this.h}if(i==8&&(r[0]&128)!=0){this.A=-1;if(s>0)this[this.g-1]|=(1<<this.h-s)-1<<s}this.m();if(e)b.ZERO.S(this,this)}function A(){var r=this.A&this.u;while(this.g>0&&this[this.g-1]==r)--this.g}function d(r){if(this.A<0)return"-"+this.I().toString(r);var t;if(r==16)t=4;else if(r==8)t=3;else if(r==2)t=1;else if(r==32)t=5;else if(r==4)t=2;else return this.N(r);var i=(1<<t)-1,n,e=false,s="",h=this.g;var a=this.h-h*this.h%t;if(h-- >0){if(a<this.h&&(n=this[h]>>a)>0){e=true;s=l(n)}while(h>=0){if(a<t){n=(this[h]&(1<<a)-1)<<t-a;n|=this[--h]>>(a+=this.h-t)}else{n=this[h]>>(a-=t)&i;if(a<=0){a+=this.h;--h}}if(n>0)e=true;if(e)s+=l(n)}}return e?s:"0"}function M(){var r=F();b.ZERO.S(this,r);return r}function m(){return this.A<0?this.I():this}function S(r){var t=this.A-r.A;if(t!=0)return t;var i=this.g;t=i-r.g;if(t!=0)return this.A<0?-t:t;while(--i>=0)if((t=this[i]-r[i])!=0)return t;return 0}function I(r){var t=1,i;if((i=r>>>16)!=0){r=i;t+=16}if((i=r>>8)!=0){r=i;t+=8}if((i=r>>4)!=0){r=i;t+=4}if((i=r>>2)!=0){r=i;t+=2}if((i=r>>1)!=0){r=i;t+=1}return t}function N(){if(this.g<=0)return 0;return this.h*(this.g-1)+I(this[this.g-1]^this.A&this.u)}function x(r,t){var i;for(i=this.g-1;i>=0;--i)t[i+r]=this[i];for(i=r-1;i>=0;--i)t[i]=0;t.g=this.g+r;t.A=this.A}function _(r,t){for(var i=r;i<this.g;++i)t[i-r]=this[i];t.g=Math.max(this.g-r,0);t.A=this.A}function E(r,t){var i=r%this.h;var n=this.h-i;var e=(1<<n)-1;var s=Math.floor(r/this.h),h=this.A<<i&this.u,a;for(a=this.g-1;a>=0;--a){t[a+s+1]=this[a]>>n|h;h=(this[a]&e)<<i}for(a=s-1;a>=0;--a)t[a]=0;t[s]=h;t.g=this.g+s+1;t.A=this.A;t.m()}function D(r,t){t.A=this.A;var i=Math.floor(r/this.h);if(i>=this.g){t.g=0;return}var n=r%this.h;var e=this.h-n;var s=(1<<n)-1;t[0]=this[i]>>n;for(var h=i+1;h<this.g;++h){t[h-i-1]|=(this[h]&s)<<e;t[h-i]=this[h]>>n}if(n>0)t[this.g-i-1]|=(this.A&s)<<e;t.g=this.g-i;t.m()}function k(r,t){var i=0,n=0,e=Math.min(r.g,this.g);while(i<e){n+=this[i]-r[i];t[i++]=n&this.u;n>>=this.h}if(r.g<this.g){n-=r.A;while(i<this.g){n+=this[i];t[i++]=n&this.u;n>>=this.h}n+=this.A}else{n+=this.A;while(i<r.g){n-=r[i];t[i++]=n&this.u;n>>=this.h}n-=r.A}t.A=n<0?-1:0;if(n<-1)t[i++]=this.v+n;else if(n>0)t[i++]=n;t.g=i;t.m()}function B(r,t){var i=this.abs(),n=r.abs();var e=i.g;t.g=e+n.g;while(--e>=0)t[e]=0;for(e=0;e<n.g;++e)t[e+i.g]=i.s(0,n[e],t,e,0,i.g);t.A=0;t.m();if(this.A!=r.A)b.ZERO.S(t,t)}function C(r){var t=this.abs();var i=r.g=2*t.g;while(--i>=0)r[i]=0;for(i=0;i<t.g-1;++i){var n=t.s(i,t[i],r,2*i,0,1);if((r[i+t.g]+=t.s(i+1,2*t[i],r,2*i+1,n,t.g-i-1))>=t.v){r[i+t.g]-=t.v;r[i+t.g+1]=1}}if(r.g>0)r[r.g-1]+=t.s(i,t[i],r,2*i,0,1);r.A=0;r.m()}function R(r,t,i){var n=r.abs();if(n.g<=0)return;var e=this.abs();if(e.g<n.g){if(t!=null)t.F(0);if(i!=null)this._(i);return}if(i==null)i=F();var s=F(),h=this.A,a=r.A;var f=this.h-I(n[n.g-1]);if(f>0){n.D(f,s);e.D(f,i)}else{n._(s);e._(i)}var u=s.g;var v=s[u-1];if(v==0)return;var o=v*(1<<this.l)+(u>1?s[u-2]>>this.p:0);var l=this.o/o,c=(1<<this.l)/o,w=1<<this.p;var y=i.g,p=y-u,g=t==null?F():t;s.k(p,g);if(i.B(g)>=0){i[i.g++]=1;i.S(g,i)}b.ONE.k(u,g);g.S(s,s);while(s.g<u)s[s.g++]=0;while(--p>=0){var A=i[--y]==v?this.u:Math.floor(i[y]*l+(i[y-1]+w)*c);if((i[y]+=s.s(0,A,i,p,0,u))<A){s.k(p,g);i.S(g,i);while(i[y]<--A)i.S(g,i)}}if(t!=null){i.C(u,t);if(h!=a)b.ZERO.S(t,t)}i.g=u;i.m();if(f>0)i.R(f,i);if(h<0)b.ZERO.S(i,i)}function j(r){var t=F();this.abs().j(r,null,t);if(this.A<0&&t.B(b.ZERO)>0)r.S(t,t);return t}function q(r){this.q=r}function z(r){if(r.A<0||r.B(this.q)>=0)return r.U(this.q);else return r}function U(r){return r}function $(r){r.j(this.q,null,r)}function G(r,t,i){r.$(t,i);this.reduce(i)}function H(r,t){r.G(t);this.reduce(t)}q.prototype.H=z;q.prototype.J=U;q.prototype.reduce=$;q.prototype.K=G;q.prototype.L=H;function J(){if(this.g<1)return 0;var r=this[0];if((r&1)==0)return 0;var t=r&3;t=t*(2-(r&15)*t)&15;t=t*(2-(r&255)*t)&255;t=t*(2-((r&65535)*t&65535))&65535;t=t*(2-r*t%this.v)%this.v;return t>0?this.v-t:-t}function K(r){this.q=r;this.O=r.P();this.T=this.O&32767;this.V=this.O>>15;this.W=(1<<r.h-15)-1;this.X=2*r.g}function L(r){var t=F();r.abs().k(this.q.g,t);t.j(this.q,null,t);if(r.A<0&&t.B(b.ZERO)>0)this.q.S(t,t);return t}function O(r){var t=F();r._(t);this.reduce(t);return t}function P(r){while(r.g<=this.X)r[r.g++]=0;for(var t=0;t<this.q.g;++t){var i=r[t]&32767;var n=i*this.T+((i*this.V+(r[t]>>15)*this.T&this.W)<<15)&r.u;i=t+this.q.g;r[i]+=this.q.s(0,n,r,t,0,this.q.g);while(r[i]>=r.v){r[i]-=r.v;r[++i]++}}r.m();r.C(this.q.g,r);if(r.B(this.q)>=0)r.S(this.q,r)}function Q(r,t){r.G(t);this.reduce(t)}function T(r,t,i){r.$(t,i);this.reduce(i)}K.prototype.H=L;K.prototype.J=O;K.prototype.reduce=P;K.prototype.K=T;K.prototype.L=Q;function V(){return(this.g>0?this[0]&1:this.A)==0}function W(r,t){if(r>4294967295||r<1)return b.ONE;var i=F(),n=F(),e=t.H(this),s=I(r)-1;e._(i);while(--s>=0){t.L(i,n);if((r&1<<s)>0)t.K(n,e,i);else{var h=i;i=n;n=h}}return t.J(i)}function X(r,t){var i;if(r<256||t.Y())i=new q(t);else i=new K(t);return this.exp(r,i)}b.prototype._=w;b.prototype.F=y;b.prototype.i=g;b.prototype.m=A;b.prototype.k=x;b.prototype.C=_;b.prototype.D=E;b.prototype.R=D;b.prototype.S=k;b.prototype.$=B;b.prototype.G=C;b.prototype.j=R;b.prototype.P=J;b.prototype.Y=V;b.prototype.exp=W;b.prototype.toString=d;b.prototype.I=M;b.prototype.abs=m;b.prototype.B=S;b.prototype.Z=N;b.prototype.U=j;b.prototype.rr=X;b.ZERO=p(0);b.ONE=p(1);function Y(){this.tr=0;this.ir=0;this.nr=new Array}function Z(r){var t,i,n;for(t=0;t<256;++t)this.nr[t]=t;i=0;for(t=0;t<256;++t){i=i+this.nr[t]+r[t%r.length]&255;n=this.nr[t];this.nr[t]=this.nr[i];this.nr[i]=n}this.tr=0;this.ir=0}function rr(){var r;this.tr=this.tr+1&255;this.ir=this.ir+this.nr[this.tr]&255;r=this.nr[this.tr];this.nr[this.tr]=this.nr[this.ir];this.nr[this.ir]=r;return this.nr[r+this.nr[this.tr]&255]}Y.prototype.init=Z;Y.prototype.next=rr;function tr(){return new Y}var ir=256;var nr;var er;var sr;function hr(r){er[sr++]^=r&255;er[sr++]^=r>>8&255;er[sr++]^=r>>16&255;er[sr++]^=r>>24&255;if(sr>=ir)sr-=ir}function ar(){hr((new Date).getTime())}if(er==null){er=new Array;sr=0;var fr;if(window.crypto&&window.crypto.getRandomValues){var ur=new Uint8Array(32);window.crypto.getRandomValues(ur);for(fr=0;fr<32;++fr)er[sr++]=ur[fr]}if(navigator.appName=="Netscape"&&navigator.appVersion<"5"&&window.crypto){var vr=window.crypto.random(32);for(fr=0;fr<vr.length;++fr)er[sr++]=vr.charCodeAt(fr)&255}while(sr<ir){fr=Math.floor(65536*Math.random());er[sr++]=fr>>>8;er[sr++]=fr&255}sr=0;ar()}function or(){if(nr==null){ar();nr=tr();nr.init(er);for(sr=0;sr<er.length;++sr)er[sr]=0;sr=0}return nr.next()}function lr(r){var t;for(t=0;t<r.length;++t)r[t]=or()}function cr(){}cr.prototype.er=lr;function wr(r,t){return new b(r,t)}function yr(r){var t=r.toString();var i="";for(var n=0;n<t.length;n+=2)i+=String.fromCharCode(parseInt(t.substr(n,2),16));return i}function pr(r,t){var i="";var n=0;while(n+t<r.length){i+=r.substring(n,n+t)+"\n";n+=t}return i+r.substring(n,r.length)}function gr(r){if(r<16)return"0"+r.toString(16);else return r.toString(16)}function Ar(r,t){if(t<r.length+11){alert("Message too long for RSA");return null}var i=new Array;var n=r.length-1;var e=8;var s=new cr;var h=new Array;while(n>=0&&e>0){e--;h[0]=0;while(h[0]==0)s.er(h);i[--t]=h[0]}i[--t]=8;i[--t]=4;while(n>=0&&t>0)i[--t]=r.charCodeAt(n--);i[--t]=32;i[--t]=4;i[--t]=28;i[--t]=48;i[--t]=0;while(t>2){h[0]=0;while(h[0]==0)s.er(h);i[--t]=h[0]}i[--t]=2;i[--t]=0;return new b(i)}function br(){this.n=null;this.e=0;this.d=null;this.sr=null;this.hr=null;this.ar=null;this.ur=null;this.vr=null}function Fr(r,t){if(r!=null&&t!=null&&r.length>0&&t.length>0){this.n=wr(r,16);this.e=parseInt(t,16)}else alert("Invalid RSA public key")}function Mr(r){return r.rr(this.e,this.n)}function mr(r){var t=Ar(r,this.n.Z()+7>>3);var n=this.n.Z()+7>>3;if(t==null)return null;var e=this.or(t);e=t.rr(this.e,this.n);if(e==null)return null;var s=e.toString(16);for(i=s.length;i<n*2;i++){s="0"+s}return s}br.prototype.or=Mr;br.prototype.lr=Fr;br.prototype.encrypt=mr;function Sr(r,t,i,n,e,s){var h=new Array(16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756);var a=new Array(-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344);var f=new Array(520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584);var u=new Array(8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928);var v=new Array(256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080);var o=new Array(536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312);var l=new Array(2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154);var c=new Array(268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696);var w=Ir(r);var y=0,p,g,A,b,F,d,M,m,S;var I,N,x,_;var E,D;var k=t.length;var B=0;var C=w.length==32?3:9;if(C==3){S=i?new Array(0,32,2):new Array(30,-2,-2)}else{S=i?new Array(0,32,2,62,30,-2,64,96,2):new Array(94,62,-2,32,64,2,30,-2,-2)}if(s==2)t+="        ";else if(s==1){A=8-k%8;t+=String.fromCharCode(A,A,A,A,A,A,A,A);if(A==8)k+=8}else if(!s)t+="\0\0\0\0\0\0\0\0";result="";tempresult="";if(n==1){I=e.charCodeAt(y++)<<24|e.charCodeAt(y++)<<16|e.charCodeAt(y++)<<8|e.charCodeAt(y++);x=e.charCodeAt(y++)<<24|e.charCodeAt(y++)<<16|e.charCodeAt(y++)<<8|e.charCodeAt(y++);y=0}while(y<k){M=t.charCodeAt(y++)<<24|t.charCodeAt(y++)<<16|t.charCodeAt(y++)<<8|t.charCodeAt(y++);m=t.charCodeAt(y++)<<24|t.charCodeAt(y++)<<16|t.charCodeAt(y++)<<8|t.charCodeAt(y++);if(n==1){if(i){M^=I;m^=x}else{N=I;_=x;I=M;x=m}}A=(M>>>4^m)&252645135;m^=A;M^=A<<4;A=(M>>>16^m)&65535;m^=A;M^=A<<16;A=(m>>>2^M)&858993459;M^=A;m^=A<<2;A=(m>>>8^M)&16711935;M^=A;m^=A<<8;A=(M>>>1^m)&1431655765;m^=A;M^=A<<1;M=M<<1|M>>>31;m=m<<1|m>>>31;for(g=0;g<C;g+=3){E=S[g+1];D=S[g+2];for(p=S[g];p!=E;p+=D){F=m^w[p];d=(m>>>4|m<<28)^w[p+1];A=M;M=m;m=A^(a[F>>>24&63]|u[F>>>16&63]|o[F>>>8&63]|c[F&63]|h[d>>>24&63]|f[d>>>16&63]|v[d>>>8&63]|l[d&63])}A=M;M=m;m=A}M=M>>>1|M<<31;m=m>>>1|m<<31;A=(M>>>1^m)&1431655765;m^=A;M^=A<<1;A=(m>>>8^M)&16711935;M^=A;m^=A<<8;A=(m>>>2^M)&858993459;M^=A;m^=A<<2;A=(M>>>16^m)&65535;m^=A;M^=A<<16;A=(M>>>4^m)&252645135;m^=A;M^=A<<4;if(n==1){if(i){I=M;x=m}else{M^=N;m^=_}}tempresult+=String.fromCharCode(M>>>24,M>>>16&255,M>>>8&255,M&255,m>>>24,m>>>16&255,m>>>8&255,m&255);B+=8;if(B==512){result+=tempresult;tempresult="";B=0}}return result+tempresult}function Ir(r){pc2bytes0=new Array(0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964);pc2bytes1=new Array(0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697);pc2bytes2=new Array(0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272);pc2bytes3=new Array(0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144);pc2bytes4=new Array(0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256);pc2bytes5=new Array(0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488);pc2bytes6=new Array(0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746);pc2bytes7=new Array(0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568);pc2bytes8=new Array(0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578);pc2bytes9=new Array(0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488);pc2bytes10=new Array(0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800);pc2bytes11=new Array(0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744);pc2bytes12=new Array(0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128);pc2bytes13=new Array(0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261);var t=r.length>8?3:1;var i=new Array(32*t);var n=new Array(0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0);var e,s,h=0,a=0,f;for(var u=0;u<t;u++){left=r.charCodeAt(h++)<<24|r.charCodeAt(h++)<<16|r.charCodeAt(h++)<<8|r.charCodeAt(h++);right=r.charCodeAt(h++)<<24|r.charCodeAt(h++)<<16|r.charCodeAt(h++)<<8|r.charCodeAt(h++);f=(left>>>4^right)&252645135;right^=f;left^=f<<4;f=(right>>>-16^left)&65535;left^=f;right^=f<<-16;f=(left>>>2^right)&858993459;right^=f;left^=f<<2;f=(right>>>-16^left)&65535;left^=f;right^=f<<-16;f=(left>>>1^right)&1431655765;right^=f;left^=f<<1;f=(right>>>8^left)&16711935;left^=f;right^=f<<8;f=(left>>>1^right)&1431655765;right^=f;left^=f<<1;f=left<<8|right>>>20&240;left=right<<24|right<<8&16711680|right>>>8&65280|right>>>24&240;right=f;for(var v=0;v<n.length;v++){if(n[v]){left=left<<2|left>>>26;right=right<<2|right>>>26}else{left=left<<1|left>>>27;right=right<<1|right>>>27}left&=-15;right&=-15;e=pc2bytes0[left>>>28]|pc2bytes1[left>>>24&15]|pc2bytes2[left>>>20&15]|pc2bytes3[left>>>16&15]|pc2bytes4[left>>>12&15]|pc2bytes5[left>>>8&15]|pc2bytes6[left>>>4&15];s=pc2bytes7[right>>>28]|pc2bytes8[right>>>24&15]|pc2bytes9[right>>>20&15]|pc2bytes10[right>>>16&15]|pc2bytes11[right>>>12&15]|pc2bytes12[right>>>8&15]|pc2bytes13[right>>>4&15];f=(s>>>16^e)&65535;i[a++]=e^f;i[a++]=s^f<<16}}return i}function Nr(r){var t="";var i=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");for(var n=0;n<r.length;n++){t+=i[r.charCodeAt(n)>>4]+i[r.charCodeAt(n)&15]}return t}function xr(r){var t="";for(var i=r.substr(0,2)=="0x"?2:0;i<r.length;i+=2){t+=String.fromCharCode(parseInt(r.substr(i,2),16))}return t}function _r(r,t){var i;var n="";for(i=0;i<r.length;i++)n+=String.fromCharCode(parseInt(r.charCodeAt(i)^t.charCodeAt(i)));return n}function Er(r,t){var i=xr(r.substring(0,16));var n=xr(r.substring(16,32));if(t.length%24>0){for(s=t.length%24;s<24;s++){t+="|"}}var e=t.length/8;var s;var h="";var a="";var f="";var u=xr("0000000000000000");for(s=0;s<e;s++){f=t.substring(s*8,(s+1)*8);if(s>0){a=_r(a,f)}else{a=f}a=Sr(i,a,1,1,u,3)}a=Sr(n,a,0,1,u,3);a=Sr(i,a,1,1,u,3);return Nr(a).toUpperCase()}function Dr(r,t){var i=xr(r.substring(0,16));var n=xr(r.substring(16,32));var e=t.length/16;var s;var h="";var a="";var f=xr("0000000000000000");for(s=0;s<e;s++){a=xr(t.substring(s*16,(s+1)*16));a=Sr(i,a,0,1,f,3);a=Sr(n,a,1,1,f,3);a=Sr(i,a,0,1,f,3);h+=a}return Nr(h).toUpperCase().substring(0,48)+h.substring(24)}function kr(r){r=""+r;r=r.split(",").join("");ret=""+parseFloat(r);if(ret=="NaN"){return 0}else{return parseFloat(r)}}function Br(r){var t=""+r;var i=t.split(".");var n=false;if(i.length>=2){n=i[1].length>2}r=kr(r);if(n){return r.format("0,000.000")}else{if(i.length>=2){return r.format("0,000.00")}else{return r.format("0,000")}}}function Cr(r){r+="";var t=/^\d|\.|-$/;var i="";for(var n=0;n<r.length;n++){if(t.test(r.charAt(n))){if(!(r.charAt(n)=="."&&i.indexOf(".")!=-1||r.charAt(n)=="-"&&i.length!=0)){i+=r.charAt(n)}}}return i}Number.prototype.format=function(r){if(!(typeof r=="string")){return""}var t=-1<r.indexOf(",");var i=Cr(r).split(".");var n=this;if(1<i.length){n=n.toFixed(i[1].length)}else if(2<i.length){throw"NumberFormatException: invalid format, formats should have no more than 1 period: "+r}else{n=n.toFixed(0)}var e=n.toString();if(t){i=e.split(".");var s=i[0];var h=[];var a=s.length;var f=Math.floor(a/3);var u=s.length%3||3;for(var v=0;v<a;v+=u){if(v!=0){u=3}h[h.length]=s.substr(v,u);f-=1}e=h.join(",");if(i[1]){e+="."+i[1]}}return r.replace(/[\d,?\.?]+/,e)};function Rr(r){return document.getElementById(r)}function jr(r,t){var i="06"+t+"FFFFFFFF";var n="0000"+r.substring(3,15);return _r(xr(i),xr(n))}function qr(r,t){var i="06"+t+"0000FFFFFFFF";var n="0000"+r.substring(3,15);return _r(xr(i),xr(n))}function zr(r,t){var n="06";var e=kr(t.substring(0,1));for(i=0;i<e-1;i++){n=n+"0"}n=n+"1";var s=kr(t.substring(1,2));for(i=e;i<s-1;i++){n=n+"0"}n=n+"1";for(i=s;i<6;i++){n=n+"0"}n=n+"FFFFFFFF";var h="0000"+r.substring(3,15);return _r(xr(n),xr(h))}function Ur(){var r="";var t="0123456789ABCDEF";var i;for(i=0;i<64;i++){r+=t[Math.floor(Math.random()*16)]}return r}function $r(r,t,i){var n=Lr();var e=Or(r,t,n);var s=Pr(n,i);return e+s}function Gr(r,t,i,n,e,s){var h=Lr();var a=Lr();var f=do_encrypt(r,t,h);var u=do_encrypt(r,t,a);var v=Or(h,Nr(jr(i,n)));var o=v+"|"+Or(h,e+s);var l=Er(a,o).substring(0,8);return f+"~"+u+"~"+o+"~"+l}function Hr(r,t,i,n){var e=Lr();var s=do_encrypt(r,t,e);var h=Or(e,Nr(jr(i,n)));return s+h}function Jr(r,t,i,n,e){var s=Lr();var h=do_encrypt(r,t,s);var a=Or(s,Nr(qr(i,e)));var f=Nr(zr(i,n));return h+a+f}function Kr(r,t,i,n,e){var s=Lr();var h=do_encrypt(r,t,s);var a=Or(s,Nr(jr(i,n)));var f=Or(s,Nr(jr(i,e)));return h+a+f}function createKey(){var r="";var t="0123456789ABCDEF";var i;for(i=0;i<32;i++){r+=t[Math.floor(Math.random()*16)]}return r}
function encryptMsg(r,t){t=Nr(t);if(t.length%16>0){for(s=0;s<16;s++){t+="0"}}var i=xr(r.substring(0,16));var n=xr(r.substring(16,32));var e=t.length/16;var s;var h="";var a="";var f=xr("0000000000000000");for(s=0;s<e;s++){a=xr(t.substring(s*16,(s+1)*16));a=Sr(i,a,1,1,f,3);a=Sr(n,a,0,1,f,3);a=Sr(i,a,1,1,f,3);h+=a}return Nr(h).toUpperCase()}function decryptMsg(r,t){var i=xr(r.substring(0,16));var n=xr(r.substring(16,32));var e=t.length/16;var s;var h="";var a="";var f=xr("0000000000000000");for(s=0;s<e;s++){a=xr(t.substring(s*16,(s+1)*16));a=Sr(i,a,0,1,f,3);a=Sr(n,a,1,1,f,3);a=Sr(i,a,0,1,f,3);h+=a}h=Nr(h);dr="";for(s=0;s<h.length;s+=2){if(!(h.charAt(s)=="0"&&h.charAt(s+1)=="0")){dr+=h.charAt(s)+h.charAt(s+1)}}return xr(dr)}function Tr(){Lr();Or();Pr();Qr()}
function hsm(){this.createKey=createKey;this.encryptKey=encryptKey;this.encryptMsg=encryptMsg;this.decryptMsg=decryptMsg}function Ar(r,t){if(t<r.length+11){alert("Message too long for RSA");return null}var i=new Array;var n=r.length-1;var e=8;var s=new cr;var h=new Array;while(n>=0&&e>0){e--;h[0]=0;while(h[0]==0)s.er(h);i[--t]=h[0]}i[--t]=8;i[--t]=4;while(n>=0&&t>0)i[--t]=r.charCodeAt(n--);i[--t]=32;i[--t]=4;i[--t]=44;i[--t]=48;i[--t]=0;while(t>2){h[0]=0;while(h[0]==0)s.er(h);i[--t]=h[0]}i[--t]=2;i[--t]=0;return new b(i)}var CryptoJSHSM=CryptoJSHSM||function(Math,undefined){var create=Object.create||function(){function F(){}return function(obj){var subtype;F.prototype=obj;subtype=new F;F.prototype=null;return subtype}}();var C={};var C_lib=C.lib={};var Base=C_lib.Base=function(){return{extend:function(overrides){var subtype=create(this);if(overrides){subtype.mixIn(overrides)}if(!subtype.hasOwnProperty("init")||this.init===subtype.init){subtype.init=function(){subtype.$super.init.apply(this,arguments)}}subtype.init.prototype=subtype;subtype.$super=this;return subtype},create:function(){var instance=this.extend();instance.init.apply(instance,arguments);return instance},init:function(){},mixIn:function(properties){for(var propertyName in properties){if(properties.hasOwnProperty(propertyName)){this[propertyName]=properties[propertyName]}}if(properties.hasOwnProperty("toString")){this.toString=properties.toString}},clone:function(){return this.init.prototype.extend(this)}}}();var WordArray=C_lib.WordArray=Base.extend({init:function(words,sigBytes){words=this.words=words||[];if(sigBytes!=undefined){this.sigBytes=sigBytes}else{this.sigBytes=words.length*4}},toString:function(encoder){return(encoder||Hex).stringify(this)},concat:function(wordArray){var thisWords=this.words;var thatWords=wordArray.words;var thisSigBytes=this.sigBytes;var thatSigBytes=wordArray.sigBytes;this.clamp();if(thisSigBytes%4){for(var i=0;i<thatSigBytes;i++){var thatByte=thatWords[i>>>2]>>>24-i%4*8&255;thisWords[thisSigBytes+i>>>2]|=thatByte<<24-(thisSigBytes+i)%4*8}}else{for(var i=0;i<thatSigBytes;i+=4){thisWords[thisSigBytes+i>>>2]=thatWords[i>>>2]}}this.sigBytes+=thatSigBytes;return this},clamp:function(){var words=this.words;var sigBytes=this.sigBytes;words[sigBytes>>>2]&=4294967295<<32-sigBytes%4*8;words.length=Math.ceil(sigBytes/4)},clone:function(){var clone=Base.clone.call(this);clone.words=this.words.slice(0);return clone},random:function(nBytes){var words=[];var r=function(m_w){var m_w=m_w;var m_z=987654321;var mask=4294967295;return function(){m_z=36969*(m_z&65535)+(m_z>>16)&mask;m_w=18e3*(m_w&65535)+(m_w>>16)&mask;var result=(m_z<<16)+m_w&mask;result/=4294967296;result+=.5;return result*(Math.random()>.5?1:-1)}};for(var i=0,rcache;i<nBytes;i+=4){var _r=r((rcache||Math.random())*4294967296);rcache=_r()*987654071;words.push(_r()*4294967296|0)}return new WordArray.init(words,nBytes)}});var C_enc=C.enc={};var Hex=C_enc.Hex={stringify:function(wordArray){var words=wordArray.words;var sigBytes=wordArray.sigBytes;var hexChars=[];for(var i=0;i<sigBytes;i++){var bite=words[i>>>2]>>>24-i%4*8&255;hexChars.push((bite>>>4).toString(16));hexChars.push((bite&15).toString(16))}return hexChars.join("")},parse:function(hexStr){var hexStrLength=hexStr.length;var words=[];for(var i=0;i<hexStrLength;i+=2){words[i>>>3]|=parseInt(hexStr.substr(i,2),16)<<24-i%8*4}return new WordArray.init(words,hexStrLength/2)}};var Latin1=C_enc.Latin1={stringify:function(wordArray){var words=wordArray.words;var sigBytes=wordArray.sigBytes;var latin1Chars=[];for(var i=0;i<sigBytes;i++){var bite=words[i>>>2]>>>24-i%4*8&255;latin1Chars.push(String.fromCharCode(bite))}return latin1Chars.join("")},parse:function(latin1Str){var latin1StrLength=latin1Str.length;var words=[];for(var i=0;i<latin1StrLength;i++){words[i>>>2]|=(latin1Str.charCodeAt(i)&255)<<24-i%4*8}return new WordArray.init(words,latin1StrLength)}};var Utf8=C_enc.Utf8={stringify:function(wordArray){try{return decodeURIComponent(escape(Latin1.stringify(wordArray)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(utf8Str){return Latin1.parse(unescape(encodeURIComponent(utf8Str)))}};var BufferedBlockAlgorithm=C_lib.BufferedBlockAlgorithm=Base.extend({reset:function(){this._data=new WordArray.init;this._nDataBytes=0},_append:function(data){if(typeof data=="string"){data=Utf8.parse(data)}this._data.concat(data);this._nDataBytes+=data.sigBytes},_process:function(doFlush){var processedWords;var data=this._data;var dataWords=data.words;var dataSigBytes=data.sigBytes;var blockSize=this.blockSize;var blockSizeBytes=blockSize*4;var nBlocksReady=dataSigBytes/blockSizeBytes;if(doFlush){nBlocksReady=Math.ceil(nBlocksReady)}else{nBlocksReady=Math.max((nBlocksReady|0)-this._minBufferSize,0)}var nWordsReady=nBlocksReady*blockSize;var nBytesReady=Math.min(nWordsReady*4,dataSigBytes);if(nWordsReady){for(var offset=0;offset<nWordsReady;offset+=blockSize){this._doProcessBlock(dataWords,offset)}processedWords=dataWords.splice(0,nWordsReady);data.sigBytes-=nBytesReady}return new WordArray.init(processedWords,nBytesReady)},clone:function(){var clone=Base.clone.call(this);clone._data=this._data.clone();return clone},_minBufferSize:0});var Hasher=C_lib.Hasher=BufferedBlockAlgorithm.extend({cfg:Base.extend(),init:function(cfg){this.cfg=this.cfg.extend(cfg);this.reset()},reset:function(){BufferedBlockAlgorithm.reset.call(this);this._doReset()},update:function(messageUpdate){this._append(messageUpdate);this._process();return this},finalize:function(messageUpdate){if(messageUpdate){this._append(messageUpdate)}var hash=this._doFinalize();return hash},blockSize:512/32,_createHelper:function(hasher){return function(message,cfg){return new hasher.init(cfg).finalize(message)}},_createHmacHelper:function(hasher){return function(message,key){return new C_algo.HMAC.init(hasher,key).finalize(message)}}});var C_algo=C.algo={};return C}(Math);(function(undefined){var C=CryptoJSHSM;var C_lib=C.lib;var Base=C_lib.Base;var X32WordArray=C_lib.WordArray;var C_x64=C.x64={};var X64Word=C_x64.Word=Base.extend({init:function(high,low){this.high=high;this.low=low}});var X64WordArray=C_x64.WordArray=Base.extend({init:function(words,sigBytes){words=this.words=words||[];if(sigBytes!=undefined){this.sigBytes=sigBytes}else{this.sigBytes=words.length*8}},toX32:function(){var x64Words=this.words;var x64WordsLength=x64Words.length;var x32Words=[];for(var i=0;i<x64WordsLength;i++){var x64Word=x64Words[i];x32Words.push(x64Word.high);x32Words.push(x64Word.low)}return X32WordArray.create(x32Words,this.sigBytes)},clone:function(){var clone=Base.clone.call(this);var words=clone.words=this.words.slice(0);var wordsLength=words.length;for(var i=0;i<wordsLength;i++){words[i]=words[i].clone()}return clone}})})();(function(Math){var C=CryptoJSHSM;var C_lib=C.lib;var WordArray=C_lib.WordArray;var Hasher=C_lib.Hasher;var C_algo=C.algo;var _zl=WordArray.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]);var _zr=WordArray.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]);var _sl=WordArray.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]);var _sr=WordArray.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]);var _hl=WordArray.create([0,1518500249,1859775393,2400959708,2840853838]);var _hr=WordArray.create([1352829926,1548603684,1836072691,2053994217,0]);var RIPEMD160=C_algo.RIPEMD160=Hasher.extend({_doReset:function(){this._hash=WordArray.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(M,offset){for(var i=0;i<16;i++){var offset_i=offset+i;var M_offset_i=M[offset_i];M[offset_i]=(M_offset_i<<8|M_offset_i>>>24)&16711935|(M_offset_i<<24|M_offset_i>>>8)&4278255360}var H=this._hash.words;var hl=_hl.words;var hr=_hr.words;var zl=_zl.words;var zr=_zr.words;var sl=_sl.words;var sr=_sr.words;var al,bl,cl,dl,el;var ar,br,cr,dr,er;ar=al=H[0];br=bl=H[1];cr=cl=H[2];dr=dl=H[3];er=el=H[4];var t;for(var i=0;i<80;i+=1){t=al+M[offset+zl[i]]|0;if(i<16){t+=f1(bl,cl,dl)+hl[0]}else if(i<32){t+=f2(bl,cl,dl)+hl[1]}else if(i<48){t+=f3(bl,cl,dl)+hl[2]}else if(i<64){t+=f4(bl,cl,dl)+hl[3]}else{t+=f5(bl,cl,dl)+hl[4]}t=t|0;t=rotl(t,sl[i]);t=t+el|0;al=el;el=dl;dl=rotl(cl,10);cl=bl;bl=t;t=ar+M[offset+zr[i]]|0;if(i<16){t+=f5(br,cr,dr)+hr[0]}else if(i<32){t+=f4(br,cr,dr)+hr[1]}else if(i<48){t+=f3(br,cr,dr)+hr[2]}else if(i<64){t+=f2(br,cr,dr)+hr[3]}else{t+=f1(br,cr,dr)+hr[4]}t=t|0;t=rotl(t,sr[i]);t=t+er|0;ar=er;er=dr;dr=rotl(cr,10);cr=br;br=t}t=H[1]+cl+dr|0;H[1]=H[2]+dl+er|0;H[2]=H[3]+el+ar|0;H[3]=H[4]+al+br|0;H[4]=H[0]+bl+cr|0;H[0]=t},_doFinalize:function(){var data=this._data;var dataWords=data.words;var nBitsTotal=this._nDataBytes*8;var nBitsLeft=data.sigBytes*8;dataWords[nBitsLeft>>>5]|=128<<24-nBitsLeft%32;dataWords[(nBitsLeft+64>>>9<<4)+14]=(nBitsTotal<<8|nBitsTotal>>>24)&16711935|(nBitsTotal<<24|nBitsTotal>>>8)&4278255360;data.sigBytes=(dataWords.length+1)*4;this._process();var hash=this._hash;var H=hash.words;for(var i=0;i<5;i++){var H_i=H[i];H[i]=(H_i<<8|H_i>>>24)&16711935|(H_i<<24|H_i>>>8)&4278255360}return hash},clone:function(){var clone=Hasher.clone.call(this);clone._hash=this._hash.clone();return clone}});function f1(x,y,z){return x^y^z}function f2(x,y,z){return x&y|~x&z}function f3(x,y,z){return(x|~y)^z}function f4(x,y,z){return x&z|y&~z}function f5(x,y,z){return x^(y|~z)}function rotl(x,n){return x<<n|x>>>32-n}C.RIPEMD160=Hasher._createHelper(RIPEMD160);C.HmacRIPEMD160=Hasher._createHmacHelper(RIPEMD160)})(Math);(function(Math){var C=CryptoJSHSM;var C_lib=C.lib;var WordArray=C_lib.WordArray;var Hasher=C_lib.Hasher;var C_algo=C.algo;var T=[];(function(){for(var i=0;i<64;i++){T[i]=Math.abs(Math.sin(i+1))*4294967296|0}})();var MD5=C_algo.MD5=Hasher.extend({_doReset:function(){this._hash=new WordArray.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(M,offset){for(var i=0;i<16;i++){var offset_i=offset+i;var M_offset_i=M[offset_i];M[offset_i]=(M_offset_i<<8|M_offset_i>>>24)&16711935|(M_offset_i<<24|M_offset_i>>>8)&4278255360}var H=this._hash.words;var M_offset_0=M[offset+0];var M_offset_1=M[offset+1];var M_offset_2=M[offset+2];var M_offset_3=M[offset+3];var M_offset_4=M[offset+4];var M_offset_5=M[offset+5];var M_offset_6=M[offset+6];var M_offset_7=M[offset+7];var M_offset_8=M[offset+8];var M_offset_9=M[offset+9];var M_offset_10=M[offset+10];var M_offset_11=M[offset+11];var M_offset_12=M[offset+12];var M_offset_13=M[offset+13];var M_offset_14=M[offset+14];var M_offset_15=M[offset+15];var a=H[0];var b=H[1];var c=H[2];var d=H[3];a=FF(a,b,c,d,M_offset_0,7,T[0]);d=FF(d,a,b,c,M_offset_1,12,T[1]);c=FF(c,d,a,b,M_offset_2,17,T[2]);b=FF(b,c,d,a,M_offset_3,22,T[3]);a=FF(a,b,c,d,M_offset_4,7,T[4]);d=FF(d,a,b,c,M_offset_5,12,T[5]);c=FF(c,d,a,b,M_offset_6,17,T[6]);b=FF(b,c,d,a,M_offset_7,22,T[7]);a=FF(a,b,c,d,M_offset_8,7,T[8]);d=FF(d,a,b,c,M_offset_9,12,T[9]);c=FF(c,d,a,b,M_offset_10,17,T[10]);b=FF(b,c,d,a,M_offset_11,22,T[11]);a=FF(a,b,c,d,M_offset_12,7,T[12]);d=FF(d,a,b,c,M_offset_13,12,T[13]);c=FF(c,d,a,b,M_offset_14,17,T[14]);b=FF(b,c,d,a,M_offset_15,22,T[15]);a=GG(a,b,c,d,M_offset_1,5,T[16]);d=GG(d,a,b,c,M_offset_6,9,T[17]);c=GG(c,d,a,b,M_offset_11,14,T[18]);b=GG(b,c,d,a,M_offset_0,20,T[19]);a=GG(a,b,c,d,M_offset_5,5,T[20]);d=GG(d,a,b,c,M_offset_10,9,T[21]);c=GG(c,d,a,b,M_offset_15,14,T[22]);b=GG(b,c,d,a,M_offset_4,20,T[23]);a=GG(a,b,c,d,M_offset_9,5,T[24]);d=GG(d,a,b,c,M_offset_14,9,T[25]);c=GG(c,d,a,b,M_offset_3,14,T[26]);b=GG(b,c,d,a,M_offset_8,20,T[27]);a=GG(a,b,c,d,M_offset_13,5,T[28]);d=GG(d,a,b,c,M_offset_2,9,T[29]);c=GG(c,d,a,b,M_offset_7,14,T[30]);b=GG(b,c,d,a,M_offset_12,20,T[31]);a=HH(a,b,c,d,M_offset_5,4,T[32]);d=HH(d,a,b,c,M_offset_8,11,T[33]);c=HH(c,d,a,b,M_offset_11,16,T[34]);b=HH(b,c,d,a,M_offset_14,23,T[35]);a=HH(a,b,c,d,M_offset_1,4,T[36]);d=HH(d,a,b,c,M_offset_4,11,T[37]);c=HH(c,d,a,b,M_offset_7,16,T[38]);b=HH(b,c,d,a,M_offset_10,23,T[39]);a=HH(a,b,c,d,M_offset_13,4,T[40]);d=HH(d,a,b,c,M_offset_0,11,T[41]);c=HH(c,d,a,b,M_offset_3,16,T[42]);b=HH(b,c,d,a,M_offset_6,23,T[43]);a=HH(a,b,c,d,M_offset_9,4,T[44]);d=HH(d,a,b,c,M_offset_12,11,T[45]);c=HH(c,d,a,b,M_offset_15,16,T[46]);b=HH(b,c,d,a,M_offset_2,23,T[47]);a=II(a,b,c,d,M_offset_0,6,T[48]);d=II(d,a,b,c,M_offset_7,10,T[49]);c=II(c,d,a,b,M_offset_14,15,T[50]);b=II(b,c,d,a,M_offset_5,21,T[51]);a=II(a,b,c,d,M_offset_12,6,T[52]);d=II(d,a,b,c,M_offset_3,10,T[53]);c=II(c,d,a,b,M_offset_10,15,T[54]);b=II(b,c,d,a,M_offset_1,21,T[55]);a=II(a,b,c,d,M_offset_8,6,T[56]);d=II(d,a,b,c,M_offset_15,10,T[57]);c=II(c,d,a,b,M_offset_6,15,T[58]);b=II(b,c,d,a,M_offset_13,21,T[59]);a=II(a,b,c,d,M_offset_4,6,T[60]);d=II(d,a,b,c,M_offset_11,10,T[61]);c=II(c,d,a,b,M_offset_2,15,T[62]);b=II(b,c,d,a,M_offset_9,21,T[63]);H[0]=H[0]+a|0;H[1]=H[1]+b|0;H[2]=H[2]+c|0;H[3]=H[3]+d|0},_doFinalize:function(){var data=this._data;var dataWords=data.words;var nBitsTotal=this._nDataBytes*8;var nBitsLeft=data.sigBytes*8;dataWords[nBitsLeft>>>5]|=128<<24-nBitsLeft%32;var nBitsTotalH=Math.floor(nBitsTotal/4294967296);var nBitsTotalL=nBitsTotal;dataWords[(nBitsLeft+64>>>9<<4)+15]=(nBitsTotalH<<8|nBitsTotalH>>>24)&16711935|(nBitsTotalH<<24|nBitsTotalH>>>8)&4278255360;dataWords[(nBitsLeft+64>>>9<<4)+14]=(nBitsTotalL<<8|nBitsTotalL>>>24)&16711935|(nBitsTotalL<<24|nBitsTotalL>>>8)&4278255360;data.sigBytes=(dataWords.length+1)*4;this._process();var hash=this._hash;var H=hash.words;for(var i=0;i<4;i++){var H_i=H[i];H[i]=(H_i<<8|H_i>>>24)&16711935|(H_i<<24|H_i>>>8)&4278255360}return hash},clone:function(){var clone=Hasher.clone.call(this);clone._hash=this._hash.clone();return clone}});function FF(a,b,c,d,x,s,t){var n=a+(b&c|~b&d)+x+t;return(n<<s|n>>>32-s)+b}function GG(a,b,c,d,x,s,t){var n=a+(b&d|c&~d)+x+t;return(n<<s|n>>>32-s)+b}function HH(a,b,c,d,x,s,t){var n=a+(b^c^d)+x+t;return(n<<s|n>>>32-s)+b}function II(a,b,c,d,x,s,t){var n=a+(c^(b|~d))+x+t;return(n<<s|n>>>32-s)+b}C.MD5=Hasher._createHelper(MD5);C.HmacMD5=Hasher._createHmacHelper(MD5)})(Math);(function(){var C=CryptoJSHSM;var C_lib=C.lib;var Base=C_lib.Base;var C_enc=C.enc;var Utf8=C_enc.Utf8;var C_algo=C.algo;var HMAC=C_algo.HMAC=Base.extend({init:function(hasher,key){hasher=this._hasher=new hasher.init;if(typeof key=="string"){key=Utf8.parse(key)}var hasherBlockSize=hasher.blockSize;var hasherBlockSizeBytes=hasherBlockSize*4;if(key.sigBytes>hasherBlockSizeBytes){key=hasher.finalize(key)}key.clamp();var oKey=this._oKey=key.clone();var iKey=this._iKey=key.clone();var oKeyWords=oKey.words;var iKeyWords=iKey.words;for(var i=0;i<hasherBlockSize;i++){oKeyWords[i]^=1549556828;iKeyWords[i]^=909522486}oKey.sigBytes=iKey.sigBytes=hasherBlockSizeBytes;this.reset()},reset:function(){var hasher=this._hasher;hasher.reset();hasher.update(this._iKey)},update:function(messageUpdate){this._hasher.update(messageUpdate);return this},finalize:function(messageUpdate){var hasher=this._hasher;var innerHash=hasher.finalize(messageUpdate);hasher.reset();var hmac=hasher.finalize(this._oKey.clone().concat(innerHash));return hmac}})})();(function(){var C=CryptoJSHSM;var C_lib=C.lib;var Base=C_lib.Base;var WordArray=C_lib.WordArray;var C_algo=C.algo;var SHA1=C_algo.SHA1;var HMAC=C_algo.HMAC;var PBKDF2=C_algo.PBKDF2=Base.extend({cfg:Base.extend({keySize:128/32,hasher:SHA1,iterations:1}),init:function(cfg){this.cfg=this.cfg.extend(cfg)},compute:function(password,salt){var cfg=this.cfg;var hmac=HMAC.create(cfg.hasher,password);var derivedKey=WordArray.create();var blockIndex=WordArray.create([1]);var derivedKeyWords=derivedKey.words;var blockIndexWords=blockIndex.words;var keySize=cfg.keySize;var iterations=cfg.iterations;while(derivedKeyWords.length<keySize){var block=hmac.update(salt).finalize(blockIndex);hmac.reset();var blockWords=block.words;var blockWordsLength=blockWords.length;var intermediate=block;for(var i=1;i<iterations;i++){intermediate=hmac.finalize(intermediate);hmac.reset();var intermediateWords=intermediate.words;for(var j=0;j<blockWordsLength;j++){blockWords[j]^=intermediateWords[j]}}derivedKey.concat(block);blockIndexWords[0]++}derivedKey.sigBytes=keySize*4;return derivedKey}});C.PBKDF2=function(password,salt,cfg){return PBKDF2.create(cfg).compute(password,salt)}})();(function(){var C=CryptoJSHSM;var C_lib=C.lib;var Base=C_lib.Base;var WordArray=C_lib.WordArray;var C_algo=C.algo;var MD5=C_algo.MD5;var EvpKDF=C_algo.EvpKDF=Base.extend({cfg:Base.extend({keySize:128/32,hasher:MD5,iterations:1}),init:function(cfg){this.cfg=this.cfg.extend(cfg)},compute:function(password,salt){var block;var cfg=this.cfg;var hasher=cfg.hasher.create();var derivedKey=WordArray.create();var derivedKeyWords=derivedKey.words;var keySize=cfg.keySize;var iterations=cfg.iterations;while(derivedKeyWords.length<keySize){if(block){hasher.update(block)}block=hasher.update(password).finalize(salt);hasher.reset();for(var i=1;i<iterations;i++){block=hasher.finalize(block);hasher.reset()}derivedKey.concat(block)}derivedKey.sigBytes=keySize*4;return derivedKey}});C.EvpKDF=function(password,salt,cfg){return EvpKDF.create(cfg).compute(password,salt)}})();CryptoJSHSM.lib.Cipher||function(undefined){var C=CryptoJSHSM;var C_lib=C.lib;var Base=C_lib.Base;var WordArray=C_lib.WordArray;var BufferedBlockAlgorithm=C_lib.BufferedBlockAlgorithm;var C_enc=C.enc;var Utf8=C_enc.Utf8;var Base64=C_enc.Base64;var C_algo=C.algo;var EvpKDF=C_algo.EvpKDF;var Cipher=C_lib.Cipher=BufferedBlockAlgorithm.extend({cfg:Base.extend(),createEncryptor:function(key,cfg){return this.create(this._ENC_XFORM_MODE,key,cfg)},createDecryptor:function(key,cfg){return this.create(this._DEC_XFORM_MODE,key,cfg)},init:function(xformMode,key,cfg){this.cfg=this.cfg.extend(cfg);this._xformMode=xformMode;this._key=key;this.reset()},reset:function(){BufferedBlockAlgorithm.reset.call(this);this._doReset()},process:function(dataUpdate){this._append(dataUpdate);return this._process()},finalize:function(dataUpdate){if(dataUpdate){this._append(dataUpdate)}var finalProcessedData=this._doFinalize();return finalProcessedData},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function selectCipherStrategy(key){if(typeof key=="string"){return PasswordBasedCipher}else{return SerializableCipher}}return function(cipher){return{encrypt:function(message,key,cfg){return selectCipherStrategy(key).encrypt(cipher,message,key,cfg)},decrypt:function(ciphertext,key,cfg){return selectCipherStrategy(key).decrypt(cipher,ciphertext,key,cfg)}}}}()});var StreamCipher=C_lib.StreamCipher=Cipher.extend({_doFinalize:function(){var finalProcessedBlocks=this._process(!!"flush");return finalProcessedBlocks},blockSize:1});var C_mode=C.mode={};var BlockCipherMode=C_lib.BlockCipherMode=Base.extend({createEncryptor:function(cipher,iv){return this.Encryptor.create(cipher,iv)},createDecryptor:function(cipher,iv){return this.Decryptor.create(cipher,iv)},init:function(cipher,iv){this._cipher=cipher;this._iv=iv}});var CBC=C_mode.CBC=function(){var CBC=BlockCipherMode.extend();CBC.Encryptor=CBC.extend({processBlock:function(words,offset){var cipher=this._cipher;var blockSize=cipher.blockSize;xorBlock.call(this,words,offset,blockSize);cipher.encryptBlock(words,offset);this._prevBlock=words.slice(offset,offset+blockSize)}});CBC.Decryptor=CBC.extend({processBlock:function(words,offset){var cipher=this._cipher;var blockSize=cipher.blockSize;var thisBlock=words.slice(offset,offset+blockSize);cipher.decryptBlock(words,offset);xorBlock.call(this,words,offset,blockSize);this._prevBlock=thisBlock}});function xorBlock(words,offset,blockSize){var block;var iv=this._iv;if(iv){block=iv;this._iv=undefined}else{block=this._prevBlock}for(var i=0;i<blockSize;i++){words[offset+i]^=block[i]}}return CBC}();var C_pad=C.pad={};var Pkcs7=C_pad.Pkcs7={pad:function(data,blockSize){var blockSizeBytes=blockSize*4;var nPaddingBytes=blockSizeBytes-data.sigBytes%blockSizeBytes;var paddingWord=nPaddingBytes<<24|nPaddingBytes<<16|nPaddingBytes<<8|nPaddingBytes;var paddingWords=[];for(var i=0;i<nPaddingBytes;i+=4){paddingWords.push(paddingWord)}var padding=WordArray.create(paddingWords,nPaddingBytes);data.concat(padding)},unpad:function(data){var nPaddingBytes=data.words[data.sigBytes-1>>>2]&255;data.sigBytes-=nPaddingBytes}};var BlockCipher=C_lib.BlockCipher=Cipher.extend({cfg:Cipher.cfg.extend({mode:CBC,padding:Pkcs7}),reset:function(){var modeCreator;Cipher.reset.call(this);var cfg=this.cfg;var iv=cfg.iv;var mode=cfg.mode;if(this._xformMode==this._ENC_XFORM_MODE){modeCreator=mode.createEncryptor}else{modeCreator=mode.createDecryptor;this._minBufferSize=1}if(this._mode&&this._mode.__creator==modeCreator){this._mode.init(this,iv&&iv.words)}else{this._mode=modeCreator.call(mode,this,iv&&iv.words);this._mode.__creator=modeCreator}},_doProcessBlock:function(words,offset){this._mode.processBlock(words,offset)},_doFinalize:function(){var finalProcessedBlocks;var padding=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){padding.pad(this._data,this.blockSize);finalProcessedBlocks=this._process(!!"flush")}else{finalProcessedBlocks=this._process(!!"flush");padding.unpad(finalProcessedBlocks)}return finalProcessedBlocks},blockSize:128/32});var CipherParams=C_lib.CipherParams=Base.extend({init:function(cipherParams){this.mixIn(cipherParams)},toString:function(formatter){return(formatter||this.formatter).stringify(this)}});var C_format=C.format={};var OpenSSLFormatter=C_format.OpenSSL={stringify:function(cipherParams){var wordArray;var ciphertext=cipherParams.ciphertext;var salt=cipherParams.salt;if(salt){wordArray=WordArray.create([1398893684,1701076831]).concat(salt).concat(ciphertext)}else{wordArray=ciphertext}return wordArray.toString(Base64)},parse:function(openSSLStr){var salt;var ciphertext=Base64.parse(openSSLStr);var ciphertextWords=ciphertext.words;if(ciphertextWords[0]==1398893684&&ciphertextWords[1]==1701076831){salt=WordArray.create(ciphertextWords.slice(2,4));ciphertextWords.splice(0,4);ciphertext.sigBytes-=16}return CipherParams.create({ciphertext:ciphertext,salt:salt})}};var SerializableCipher=C_lib.SerializableCipher=Base.extend({cfg:Base.extend({format:OpenSSLFormatter}),encrypt:function(cipher,message,key,cfg){cfg=this.cfg.extend(cfg);var encryptor=cipher.createEncryptor(key,cfg);var ciphertext=encryptor.finalize(message);var cipherCfg=encryptor.cfg;return CipherParams.create({ciphertext:ciphertext,key:key,iv:cipherCfg.iv,algorithm:cipher,mode:cipherCfg.mode,padding:cipherCfg.padding,blockSize:cipher.blockSize,formatter:cfg.format})},decrypt:function(cipher,ciphertext,key,cfg){cfg=this.cfg.extend(cfg);ciphertext=this._parse(ciphertext,cfg.format);var plaintext=cipher.createDecryptor(key,cfg).finalize(ciphertext.ciphertext);return plaintext},_parse:function(ciphertext,format){if(typeof ciphertext=="string"){return format.parse(ciphertext,this)}else{return ciphertext}}});var C_kdf=C.kdf={};var OpenSSLKdf=C_kdf.OpenSSL={execute:function(password,keySize,ivSize,salt){if(!salt){salt=WordArray.random(64/8)}var key=EvpKDF.create({keySize:keySize+ivSize}).compute(password,salt);var iv=WordArray.create(key.words.slice(keySize),ivSize*4);key.sigBytes=keySize*4;return CipherParams.create({key:key,iv:iv,salt:salt})}};var PasswordBasedCipher=C_lib.PasswordBasedCipher=SerializableCipher.extend({cfg:SerializableCipher.cfg.extend({kdf:OpenSSLKdf}),encrypt:function(cipher,message,password,cfg){cfg=this.cfg.extend(cfg);var derivedParams=cfg.kdf.execute(password,cipher.keySize,cipher.ivSize);cfg.iv=derivedParams.iv;var ciphertext=SerializableCipher.encrypt.call(this,cipher,message,derivedParams.key,cfg);ciphertext.mixIn(derivedParams);return ciphertext},decrypt:function(cipher,ciphertext,password,cfg){cfg=this.cfg.extend(cfg);ciphertext=this._parse(ciphertext,cfg.format);var derivedParams=cfg.kdf.execute(password,cipher.keySize,cipher.ivSize,ciphertext.salt);cfg.iv=derivedParams.iv;var plaintext=SerializableCipher.decrypt.call(this,cipher,ciphertext,derivedParams.key,cfg);return plaintext}})}();(function(Math){var C=CryptoJSHSM;var C_lib=C.lib;var WordArray=C_lib.WordArray;var Hasher=C_lib.Hasher;var C_algo=C.algo;var H=[];var K=[];(function(){function isPrime(n){var sqrtN=Math.sqrt(n);for(var factor=2;factor<=sqrtN;factor++){if(!(n%factor)){return false}}return true}function getFractionalBits(n){return(n-(n|0))*4294967296|0}var n=2;var nPrime=0;while(nPrime<64){if(isPrime(n)){if(nPrime<8){H[nPrime]=getFractionalBits(Math.pow(n,1/2))}K[nPrime]=getFractionalBits(Math.pow(n,1/3));nPrime++}n++}})();var W=[];var SHA256=C_algo.SHA256=Hasher.extend({_doReset:function(){this._hash=new WordArray.init(H.slice(0))},_doProcessBlock:function(M,offset){var H=this._hash.words;var a=H[0];var b=H[1];var c=H[2];var d=H[3];var e=H[4];var f=H[5];var g=H[6];var h=H[7];for(var i=0;i<64;i++){if(i<16){W[i]=M[offset+i]|0}else{var gamma0x=W[i-15];var gamma0=(gamma0x<<25|gamma0x>>>7)^(gamma0x<<14|gamma0x>>>18)^gamma0x>>>3;var gamma1x=W[i-2];var gamma1=(gamma1x<<15|gamma1x>>>17)^(gamma1x<<13|gamma1x>>>19)^gamma1x>>>10;W[i]=gamma0+W[i-7]+gamma1+W[i-16]}var ch=e&f^~e&g;var maj=a&b^a&c^b&c;var sigma0=(a<<30|a>>>2)^(a<<19|a>>>13)^(a<<10|a>>>22);var sigma1=(e<<26|e>>>6)^(e<<21|e>>>11)^(e<<7|e>>>25);var t1=h+sigma1+ch+K[i]+W[i];var t2=sigma0+maj;h=g;g=f;f=e;e=d+t1|0;d=c;c=b;b=a;a=t1+t2|0}H[0]=H[0]+a|0;H[1]=H[1]+b|0;H[2]=H[2]+c|0;H[3]=H[3]+d|0;H[4]=H[4]+e|0;H[5]=H[5]+f|0;H[6]=H[6]+g|0;H[7]=H[7]+h|0},_doFinalize:function(){var data=this._data;var dataWords=data.words;var nBitsTotal=this._nDataBytes*8;var nBitsLeft=data.sigBytes*8;dataWords[nBitsLeft>>>5]|=128<<24-nBitsLeft%32;dataWords[(nBitsLeft+64>>>9<<4)+14]=Math.floor(nBitsTotal/4294967296);dataWords[(nBitsLeft+64>>>9<<4)+15]=nBitsTotal;data.sigBytes=dataWords.length*4;this._process();return this._hash},clone:function(){var clone=Hasher.clone.call(this);clone._hash=this._hash.clone();return clone}});C.SHA256=Hasher._createHelper(SHA256);C.HmacSHA256=Hasher._createHmacHelper(SHA256)})(Math);(function(){var C=CryptoJSHSM;var C_lib=C.lib;var BlockCipher=C_lib.BlockCipher;var C_algo=C.algo;var SBOX=[];var INV_SBOX=[];var SUB_MIX_0=[];var SUB_MIX_1=[];var SUB_MIX_2=[];var SUB_MIX_3=[];var INV_SUB_MIX_0=[];var INV_SUB_MIX_1=[];var INV_SUB_MIX_2=[];var INV_SUB_MIX_3=[];(function(){var d=[];for(var i=0;i<256;i++){if(i<128){d[i]=i<<1}else{d[i]=i<<1^283}}var x=0;var xi=0;for(var i=0;i<256;i++){var sx=xi^xi<<1^xi<<2^xi<<3^xi<<4;sx=sx>>>8^sx&255^99;SBOX[x]=sx;INV_SBOX[sx]=x;var x2=d[x];var x4=d[x2];var x8=d[x4];var t=d[sx]*257^sx*16843008;SUB_MIX_0[x]=t<<24|t>>>8;SUB_MIX_1[x]=t<<16|t>>>16;SUB_MIX_2[x]=t<<8|t>>>24;SUB_MIX_3[x]=t;var t=x8*16843009^x4*65537^x2*257^x*16843008;INV_SUB_MIX_0[sx]=t<<24|t>>>8;INV_SUB_MIX_1[sx]=t<<16|t>>>16;INV_SUB_MIX_2[sx]=t<<8|t>>>24;INV_SUB_MIX_3[sx]=t;if(!x){x=xi=1}else{x=x2^d[d[d[x8^x2]]];xi^=d[d[xi]]}}})();var RCON=[0,1,2,4,8,16,32,64,128,27,54];var AES=C_algo.AES=BlockCipher.extend({_doReset:function(){var t;if(this._nRounds&&this._keyPriorReset===this._key){return}var key=this._keyPriorReset=this._key;var keyWords=key.words;var keySize=key.sigBytes/4;var nRounds=this._nRounds=keySize+6;var ksRows=(nRounds+1)*4;var keySchedule=this._keySchedule=[];for(var ksRow=0;ksRow<ksRows;ksRow++){if(ksRow<keySize){keySchedule[ksRow]=keyWords[ksRow]}else{t=keySchedule[ksRow-1];if(!(ksRow%keySize)){t=t<<8|t>>>24;t=SBOX[t>>>24]<<24|SBOX[t>>>16&255]<<16|SBOX[t>>>8&255]<<8|SBOX[t&255];t^=RCON[ksRow/keySize|0]<<24}else if(keySize>6&&ksRow%keySize==4){t=SBOX[t>>>24]<<24|SBOX[t>>>16&255]<<16|SBOX[t>>>8&255]<<8|SBOX[t&255]}keySchedule[ksRow]=keySchedule[ksRow-keySize]^t}}var invKeySchedule=this._invKeySchedule=[];for(var invKsRow=0;invKsRow<ksRows;invKsRow++){var ksRow=ksRows-invKsRow;if(invKsRow%4){var t=keySchedule[ksRow]}else{var t=keySchedule[ksRow-4]}if(invKsRow<4||ksRow<=4){invKeySchedule[invKsRow]=t}else{invKeySchedule[invKsRow]=INV_SUB_MIX_0[SBOX[t>>>24]]^INV_SUB_MIX_1[SBOX[t>>>16&255]]^INV_SUB_MIX_2[SBOX[t>>>8&255]]^INV_SUB_MIX_3[SBOX[t&255]]}}},encryptBlock:function(M,offset){this._doCryptBlock(M,offset,this._keySchedule,SUB_MIX_0,SUB_MIX_1,SUB_MIX_2,SUB_MIX_3,SBOX)},decryptBlock:function(M,offset){var t=M[offset+1];M[offset+1]=M[offset+3];M[offset+3]=t;this._doCryptBlock(M,offset,this._invKeySchedule,INV_SUB_MIX_0,INV_SUB_MIX_1,INV_SUB_MIX_2,INV_SUB_MIX_3,INV_SBOX);var t=M[offset+1];M[offset+1]=M[offset+3];M[offset+3]=t},_doCryptBlock:function(M,offset,keySchedule,SUB_MIX_0,SUB_MIX_1,SUB_MIX_2,SUB_MIX_3,SBOX){var nRounds=this._nRounds;var s0=M[offset]^keySchedule[0];var s1=M[offset+1]^keySchedule[1];var s2=M[offset+2]^keySchedule[2];var s3=M[offset+3]^keySchedule[3];var ksRow=4;for(var round=1;round<nRounds;round++){var t0=SUB_MIX_0[s0>>>24]^SUB_MIX_1[s1>>>16&255]^SUB_MIX_2[s2>>>8&255]^SUB_MIX_3[s3&255]^keySchedule[ksRow++];var t1=SUB_MIX_0[s1>>>24]^SUB_MIX_1[s2>>>16&255]^SUB_MIX_2[s3>>>8&255]^SUB_MIX_3[s0&255]^keySchedule[ksRow++];var t2=SUB_MIX_0[s2>>>24]^SUB_MIX_1[s3>>>16&255]^SUB_MIX_2[s0>>>8&255]^SUB_MIX_3[s1&255]^keySchedule[ksRow++];var t3=SUB_MIX_0[s3>>>24]^SUB_MIX_1[s0>>>16&255]^SUB_MIX_2[s1>>>8&255]^SUB_MIX_3[s2&255]^keySchedule[ksRow++];s0=t0;s1=t1;s2=t2;s3=t3}var t0=(SBOX[s0>>>24]<<24|SBOX[s1>>>16&255]<<16|SBOX[s2>>>8&255]<<8|SBOX[s3&255])^keySchedule[ksRow++];var t1=(SBOX[s1>>>24]<<24|SBOX[s2>>>16&255]<<16|SBOX[s3>>>8&255]<<8|SBOX[s0&255])^keySchedule[ksRow++];var t2=(SBOX[s2>>>24]<<24|SBOX[s3>>>16&255]<<16|SBOX[s0>>>8&255]<<8|SBOX[s1&255])^keySchedule[ksRow++];var t3=(SBOX[s3>>>24]<<24|SBOX[s0>>>16&255]<<16|SBOX[s1>>>8&255]<<8|SBOX[s2&255])^keySchedule[ksRow++];M[offset]=t0;M[offset+1]=t1;M[offset+2]=t2;M[offset+3]=t3},keySize:256/32});C.AES=BlockCipher._createHelper(AES)})();CryptoJSHSM.mode.ECB=function(){var ECB=CryptoJSHSM.lib.BlockCipherMode.extend();ECB.Encryptor=ECB.extend({processBlock:function(words,offset){this._cipher.encryptBlock(words,offset)}});ECB.Decryptor=ECB.extend({processBlock:function(words,offset){this._cipher.decryptBlock(words,offset)}});return ECB}();CryptoJSHSM.pad.NoPadding={pad:function(){},unpad:function(){}};CryptoJSHSM.mode.CTR=function(){var b=CryptoJSHSM.lib.BlockCipherMode.extend(),g=b.Encryptor=b.extend({processBlock:function(b,f){var a=this._cipher,e=a.blockSize,c=this._iv,d=this._counter;c&&(d=this._counter=c.slice(0),this._iv=void 0);c=d.slice(0);a.encryptBlock(c,0);d[e-1]=d[e-1]+1|0;for(a=0;a<e;a++)b[f+a]^=c[a]}});b.Decryptor=g;return b}();!function(t){t.enc.Bin={stringify:function(t){for(var e=t.words,r=t.sigBytes,i=[],n=0;r>n;n++)for(var o=e[n>>>2]>>>24-n%4*8&255,s=7;s>=0;s--)i.push((o>>>s&1).toString(2));return i.join("")},parse:function(e){for(var r=[0],i=31,n=0,o=0;o<e.length;o++){var s=e[o];("0"===s||"1"===s)&&(r[r.length-1]+=parseInt(s)<<i,i--,n++,0>i&&(i=31,r.push(0)))}return t.lib.WordArray.create(r,Math.ceil(n/8))}}}(CryptoJSHSM),function(t){var e;e=t.hasOwnProperty("ext")?t.ext:t.ext={},e.bitshift=function(t,e){var r,i,n=0,o=t.words,s=0;if(e>0){for(;e>31;)o.splice(0,1),o.push(0),e-=32,s++;if(0==e)return n;for(var c=o.length-s-1;c>=0;c--)r=o[c],o[c]<<=e,o[c]|=n,n=r>>>32-e}else if(0>e){for(;-31>e;)o.splice(0,0,0),o.length--,e+=32,s++;if(0==e)return n;e=-e,i=(1<<e)-1;for(var c=s;c<o.length;c++)r=o[c]&i,o[c]>>>=e,o[c]|=n,n=r<<32-e}return n},e.neg=function(t){for(var e=t.words,r=0;r<e.length;r++)e[r]=~e[r];return t},e.xor=function(t,e){for(var r=0;r<t.words.length;r++)t.words[r]^=e.words[r];return t},e.bitand=function(t,e){for(var r=t.clone(),i=r.words,n=e.words,o=0;o<i.length;o++)i[o]&=n[o];return r}}(CryptoJSHSM),function(t){var e=t.lib.WordArray,r=window.crypto,i=Int32Array;i&&r&&r.getRandomValues?e.random=function(t){var n=new i(Math.ceil(t/4));return r.getRandomValues(n),new e.init([].map.call(n,function(t){return t}),t)}:console.log("No cryptographically secure randomness source available")}(CryptoJSHSM),CryptoJSHSM.mode.CFBw=function(){function t(t,e,r){for(var i=this,n=i._cipher,o=n.blockSize,s=i._prevBlock,c=n.cfg.segmentSize/32,a=0;o/c>a;a++){s?s=s.slice(c).concat(i._ct):(s=i._iv.slice(0),i._iv=void 0),r||(i._ct=t.slice(e+a*c,e+a*c+c));var f=s.slice(0);n.encryptBlock(f,0);for(var u=0;c>u;u++)t[e+a*c+u]^=f[u];r&&(i._ct=t.slice(e+a*c,e+a*c+c))}i._prevBlock=s}var e=CryptoJSHSM.lib.BlockCipherMode.extend();return e.Encryptor=e.extend({processBlock:function(e,r){t.call(this,e,r,!0)}}),e.Decryptor=e.extend({processBlock:function(e,r){t.call(this,e,r,!1)}}),e}(),function(t){var e;e=t.hasOwnProperty("ext")?t.ext:t.ext={};{var r=(t.lib.Base,t.lib.WordArray);t.algo.AES}e.const_Zero=r.create([0,0,0,0]),e.const_One=r.create([0,0,0,1]),e.const_Rb=r.create([0,0,0,135]),e.const_Rb_Shifted=r.create([2147483648,0,0,67]),e.const_nonMSB=r.create([4294967295,4294967295,2147483647,2147483647]),e.isWordArray=function(t){return t&&"function"==typeof t.clamp&&"function"==typeof t.concat&&"array"==typeof t.words},t.pad.OneZeroPadding={pad:function(t,e){for(var i=4*e,n=i-t.sigBytes%i,o=[],s=0;n>s;s+=4){var c=0;0===s&&(c=2147483648),o.push(c)}var a=r.create(o,n);t.concat(a)},unpad:function(){}},t.pad.NoPadding={pad:function(){},unpad:function(){}},e.leftmostBytes=function(t,e){var r=t.clone();return r.sigBytes=e,r.clamp(),r},e.rightmostBytes=function(t,r){t.clamp();var i=32,n=t.clone(),o=8*(n.sigBytes-r);if(o>=i){var s=Math.floor(o/i);o-=s*i,n.words.splice(0,s),n.sigBytes-=s*i/8}return o>0&&(e.bitshift(n,o),n.sigBytes-=o/8),n},e.popWords=function(t,r){var i=e.leftmostBytes(t,4*r);return t.words=t.words.slice(r),t.sigBytes-=4*r,i},e.shiftBytes=function(t,i){i=i||16;var n=i%4;i-=n;for(var o=r.create(),s=0;i>s;s+=4)o.words.push(t.words.shift()),t.sigBytes-=4,o.sigBytes+=4;return n>0&&(o.words.push(t.words[0]),o.sigBytes+=n,e.bitshift(t,8*n),t.sigBytes-=n),o},e.xorendBytes=function(t,r){return e.leftmostBytes(t,t.sigBytes-r.sigBytes).concat(e.xor(e.rightmostBytes(t,r.sigBytes),r))},e.dbl=function(t){var r=e.msb(t);return e.bitshift(t,1),1===r&&e.xor(t,e.const_Rb),t},e.inv=function(t){var r=1&t.words[4];return e.bitshift(t,-1),1===r&&e.xor(t,e.const_Rb_Shifted),t},e.equals=function(t,e){if(!e||!e.words||t.sigBytes!==e.sigBytes)return!1;t.clamp(),e.clamp();for(var r=0;r<t.words.length;r++)if(t.words[r]!==e.words[r])return!1;return!0},e.msb=function(t){return t.words[0]>>>31}}(CryptoJSHSM),CryptoJSHSM.mode.CFBb=function(){function t(t,e,o){var s,c,a,f=this,u=f._cipher,h=32*u.blockSize,l=f._prevBlock,p=u.cfg.segmentSize,d=[];for(s=31;p>s;s+=32)d.push(4294967295);for(d.push((1<<p)-1<<32-p),s=d.length;s<t.length;s++)d.push(0);d=r.create(d);var _,y=d.clone(),g=y.clone();for(i(g,32*-e),s=0;h/p>s;s++){if(l){for(l=r.create(l),i(l,p),l=l.words,previousCiphertextSegment=f._ct;previousCiphertextSegment.length<h/32;)previousCiphertextSegment.push(0);previousCiphertextSegment=r.create(previousCiphertextSegment),i(previousCiphertextSegment,-h+p);for(var c=0;c<l.length;c++)l[c]|=previousCiphertextSegment.words[c]}else l=f._iv.slice(0),f._iv=void 0;a=32*e+s*p;var v=r.create(t.slice(0));i(v,a),o||(f._ct=v.words.slice(0,Math.ceil(p/32)));var B=l.slice(0);for(u.encryptBlock(B,0),c=0;c<Math.ceil(p/32);c++)v.words[c]^=B[c];for(c=0;c<v.words.length;c++)v.words[c]&=d.words[c];for(o&&(f._ct=v.words.slice(0,Math.ceil(p/32))),_=n(g.clone()),c=0;c<t.length;c++)t[c]&=_.words[c];for(i(v,-a),c=0;c<t.length;c++)t[c]|=v.words[c];i(y,-p),i(g,-p)}f._prevBlock=l}var e=CryptoJSHSM.lib.BlockCipherMode.extend(),r=CryptoJSHSM.lib.WordArray,i=CryptoJSHSM.ext.bitshift,n=CryptoJSHSM.ext.neg;return e.Encryptor=e.extend({processBlock:function(e,r){t.call(this,e,r,!0)}}),e.Decryptor=e.extend({processBlock:function(e,r){t.call(this,e,r,!1)}}),e}(),function(t){function e(e,r){var o=n.createEncryptor(e,{iv:i.create(),padding:t.pad.NoPadding}),s=o.finalize(r);return s}var r=t.lib.Base,i=t.lib.WordArray,n=t.algo.AES,o=t.ext,s=t.pad.OneZeroPadding,c=t.algo.CMAC=r.extend({init:function(t){var r=e(t,o.const_Zero),i=r.clone();if(o.dbl(i),this._isTwo()){var n=r.clone();o.inv(n)}else{var n=i.clone();o.dbl(n)}this._K1=i,this._K2=n,this._K=t,this._const_Bsize=16,this.reset()},reset:function(){this._x=o.const_Zero.clone(),this._counter=0,this._buffer=i.create()},update:function(r){if(!r)return this;var i=this._buffer,n=this._const_Bsize;for("string"==typeof r&&(r=t.enc.Utf8.parse(r)),i.concat(r);i.sigBytes>n;){var s=o.shiftBytes(i,n);o.xor(this._x,s),this._x.clamp(),this._x=e(this._K,this._x),this._counter++}return this},finalize:function(t){this.update(t);var r=this._buffer,i=this._const_Bsize,n=r.clone();return r.sigBytes===i?o.xor(n,this._K1):(s.pad(n,i/4),o.xor(n,this._K2)),o.xor(n,this._x),this.reset(),e(this._K,n)},_isTwo:function(){return!1}});t.CMAC=function(t,e){return c.create(t).finalize(e)},t.algo.OMAC1=c,t.algo.OMAC2=c.extend({_isTwo:function(){return!0}})}(CryptoJSHSM),function(t){{var e=t.lib.Base,r=t.lib.WordArray,i=(t.algo.AES,t.ext),n=t.pad.OneZeroPadding,o=t.algo.CMAC,s=t.algo.S2V=e.extend({init:function(t){this._blockSize=16,this._cmacAD=o.create(t),this._cmacPT=o.create(t),this.reset()},reset:function(){this._buffer=r.create(),this._cmacAD.reset(),this._cmacPT.reset(),this._d=this._cmacAD.finalize(i.const_Zero),this._empty=!0,this._ptStarted=!1},updateAAD:function(e){return this._ptStarted?this:e?("string"==typeof e&&(e=t.enc.Utf8.parse(e)),this._d=i.xor(i.dbl(this._d),this._cmacAD.finalize(e)),this._empty=!1,this):this},update:function(e){if(!e)return this;this._ptStarted=!0;var r=this._buffer,n=this._blockSize,o=n/4,s=this._cmacPT;for("string"==typeof e&&(e=t.enc.Utf8.parse(e)),r.concat(e);r.sigBytes>=2*n;){this._empty=!1;var c=i.popWords(r,o);s.update(c)}return this},finalize:function(t){this.update(t);var e=this._blockSize,r=this._buffer;if(this._empty&&0===r.sigBytes)return this._cmacAD.finalize(i.const_One);var o;return r.sigBytes>=e?o=i.xorendBytes(r,this._d):(n.pad(r,e),o=i.xor(i.dbl(this._d),r)),this._cmacPT.finalize(o)}});t.SIV=e.extend({init:function(t){var e=t.sigBytes/2;this._s2vKey=i.shiftBytes(t,e),this._ctrKey=t},encrypt:function(e,r){!r&&e&&(r=e,e=[]);var n=s.create(this._s2vKey);Array.prototype.forEach.call(e,function(t){n.updateAAD(t)});var o=n.finalize(r),c=i.bitand(o,i.const_nonMSB),a=t.AES.encrypt(r,this._ctrKey,{iv:c,mode:t.mode.CTR,padding:t.pad.NoPadding});return o.concat(a.ciphertext)},decrypt:function(e,r){!r&&e&&(r=e,e=[]);var n=i.shiftBytes(r,16),o=i.bitand(n,i.const_nonMSB),c=t.AES.decrypt({ciphertext:r},this._ctrKey,{iv:o,mode:t.mode.CTR,padding:t.pad.NoPadding}),a=s.create(this._s2vKey);Array.prototype.forEach.call(e,function(t){a.updateAAD(t)});var f=a.finalize(c);return i.equals(n,f)?c:!1}})}}(CryptoJSHSM),function(t){{var e=t.lib.Base,r=t.lib.WordArray,i=t.algo.AES,n=t.ext,o=t.algo.CMAC,s=r.create([0,0,0,0]),c=r.create([0,0,0,1]),a=r.create([0,0,0,2]),f=16;t.EAX=e.extend({init:function(t,e){var r;if(e&&e.splitKey){var i=Math.floor(t.sigBytes/2);r=n.shiftBytes(t,i)}else r=t.clone();this._ctrKey=t,this._mac=o.create(r),this._tagLen=e&&e.tagLength||f,this.reset()},reset:function(){this._mac.update(c),this._ctr&&this._ctr.reset()},updateAAD:function(t){return this._mac.update(t),this},initCrypt:function(e,o){var c=this;return c._tag=c._mac.finalize(),c._isEnc=e,c._mac.update(s),o=c._mac.finalize(o),n.xor(c._tag,o),c._ctr=i.createEncryptor(c._ctrKey,{iv:o,mode:t.mode.CTR,padding:t.pad.NoPadding}),c._buf=r.create(),c._mac.update(a),c},update:function(e){"string"==typeof e&&(e=t.enc.Utf8.parse(e));var i=this,o=i._buf,s=i._isEnc;o.concat(e);var c=s?o.sigBytes:Math.max(o.sigBytes-i._tagLen,0),a=c>0?n.shiftBytes(o,c):r.create(),f=i._ctr.process(a);return i._mac.update(s?f:a),f},finalize:function(t){var e=this,i=t?e.update(t):r.create(),o=e._mac,s=e._ctr.finalize();if(e._isEnc){var c=o.finalize(s);return n.xor(e._tag,c),e.reset(),i.concat(s).concat(e._tag)}var c=o.finalize();return n.xor(e._tag,c),e.reset(),n.equals(e._tag,e._buf)?i.concat(s):!1},encrypt:function(t,e,r){var i=this;return r&&Array.prototype.forEach.call(r,function(t){i.updateAAD(t)}),i.initCrypt(!0,e),i.finalize(t)},decrypt:function(t,e,r){var i=this;return r&&Array.prototype.forEach.call(r,function(t){i.updateAAD(t)}),i.initCrypt(!1,e),i.finalize(t)}})}}(CryptoJSHSM);function Arcfour(){this.i=0;this.j=0;this.S=new Array}function ARC4init(key){var i,j,t;for(i=0;i<256;++i)this.S[i]=i;j=0;for(i=0;i<256;++i){j=j+this.S[i]+key[i%key.length]&255;t=this.S[i];this.S[i]=this.S[j];this.S[j]=t}this.i=0;this.j=0}function ARC4next(){var t;this.i=this.i+1&255;this.j=this.j+this.S[this.i]&255;t=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=t;return this.S[t+this.S[this.i]&255]}Arcfour.prototype.init=ARC4init;Arcfour.prototype.next=ARC4next;function prng_newstate(){return new Arcfour}var rng_psize=256;var rng_state;var rng_pool;var rng_pptr;function rng_seed_int(x){rng_pool[rng_pptr++]^=x&255;rng_pool[rng_pptr++]^=x>>8&255;rng_pool[rng_pptr++]^=x>>16&255;rng_pool[rng_pptr++]^=x>>24&255;if(rng_pptr>=rng_psize)rng_pptr-=rng_psize}function rng_seed_time(){rng_seed_int((new Date).getTime())}if(rng_pool==null){rng_pool=new Array;rng_pptr=0;var t;for(t=0;t<32;++t)rng_pool[rng_pptr++]=parseInt(Math.random()*1e10,10);while(rng_pptr<rng_psize){t=Math.floor(65536*Math.random());rng_pool[rng_pptr++]=t>>>8;rng_pool[rng_pptr++]=t&255}rng_pptr=0;rng_seed_time()}function rng_get_byte(){if(rng_state==null){rng_seed_time();rng_state=prng_newstate();rng_state.init(rng_pool);for(rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr)rng_pool[rng_pptr]=0;rng_pptr=0}return rng_state.next()}function rng_get_bytes(ba){var i;for(i=0;i<ba.length;++i)ba[i]=rng_get_byte()}function SecureRandom(){}SecureRandom.prototype.nextBytes=rng_get_bytes;function hex2a(hexx){var hex=hexx.toString();var str="";for(var i=0;i<hex.length;i+=2)str+=String.fromCharCode(parseInt(hex.substr(i,2),16));return str}function linebrk(s,n){var ret="";var i=0;while(i+n<s.length){ret+=s.substring(i,i+n)+"\n";i+=n}return ret+s.substring(i,s.length)}function byte2Hex(b){if(b<16)return"0"+b.toString(16);else return b.toString(16)}
function stringToHex(s){var i;var result = "";for (i=0; i<s.length; i++) {hex = s.charCodeAt(i).toString(16);result += ("000"+hex).slice(-4);}return result}
function stringToHex2(s){var r="";var hexes=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");for(var i=0;i<s.length;i++){r+=hexes[s.charCodeAt(i)>>4]+hexes[s.charCodeAt(i)&15]}return r}
function hexToString(h){var r="";for(var i=0;i<h.length;i+=4){if(parseInt(h.substr(i,4),16)>0){r+=String.fromCharCode(parseInt(h.substr(i,4),16))}}return r}
function hexToString2(h){var r="";for(var i=h.substr(0,2)=="0x"?2:0;i<h.length;i+=2){r+=String.fromCharCode(parseInt(h.substr(i,2),16))}return r}
function hexToString3(h){var r="";for(var i=h.substr(0,2)=="0x"?2:0;i<h.length;i+=2){if(parseInt(h.substr(i,2),16)>0){r+=String.fromCharCode(parseInt(h.substr(i,2),16))}}return r}
function createKey(){var key="";var data="0123456789ABCDEF";var i;for(i=0;i<64;i++){key+=data[Math.floor(Math.random()*16)]}return key}
function createPadding(){var key="";var data="0123456789ABCDEF";var i;for(i=0;i<16;i++){key+=data[Math.floor(Math.random()*16)]}return key}
function SHA256Pad(data){return data}
function xor(a1,a2){var i;var s="";for(i=0;i<a1.length;i++)s+=String.fromCharCode(parseInt(a1.charCodeAt(i)^a2.charCodeAt(i)));return s}
function pinblok(sCardNo,sPIN){
	var s1="06"+sPIN+"FFFFFFFF";
	var s2="0000"+sCardNo.substring(3,15);
	return stringToHex2(xor(hexToString2(s1),hexToString2(s2)))}function encryptKey(r,t,i){var n=new br;n.lr(r,t);return n.encrypt(yr(i))}
function encryptMsg(sKey,sMsg){var key=CryptoJSHSM.enc.Hex.parse(sKey);sMsg=stringToHex2(sMsg);if(sMsg.length%32>0){for(i=sMsg.length%32;i<32;i++){sMsg+="0"}}var encrypted=CryptoJSHSM.AES.encrypt(CryptoJSHSM.enc.Hex.parse(sMsg),key,{mode:CryptoJSHSM.mode.ECB,padding:CryptoJSHSM.pad.NoPadding});return encrypted.toString().toUpperCase()}
function decryptMsg(sKey,seMsg){
	var key=CryptoJSHSM.enc.Hex.parse(sKey);
	var decrypted=hexToString3(CryptoJSHSM.AES.decrypt({ciphertext:CryptoJSHSM.enc.Hex.parse(seMsg)},key,{mode:CryptoJSHSM.mode.ECB,padding:CryptoJSHSM.pad.NoPadding}).toString());
	return decrypted
}
function encryptMsg_new(sKey,sMsg){var key=CryptoJSHSM.enc.Hex.parse(sKey);sMsg=stringToHex(sMsg);if(sMsg.length%32>0){for(i=sMsg.length%32;i<32;i++){sMsg+="0"}}var encrypted=CryptoJSHSM.AES.encrypt(CryptoJSHSM.enc.Hex.parse(sMsg),key,{mode:CryptoJSHSM.mode.ECB,padding:CryptoJSHSM.pad.NoPadding});return encrypted.toString().toUpperCase()}
function decryptMsg_new(sKey,seMsg){
	var key=CryptoJSHSM.enc.Hex.parse(sKey);
	var decrypted=hexToString(CryptoJSHSM.AES.decrypt({ciphertext:CryptoJSHSM.enc.Hex.parse(seMsg)},key,{mode:CryptoJSHSM.mode.ECB,padding:CryptoJSHSM.pad.NoPadding}).toString());
	return decrypted
}
function encryptPIN(sPKey,sExp,sCardNo,sPIN){
	var k1=CryptoJSHSM.enc.Hex.parse(createKey());
	var ek1=encryptKey(sPKey,sExp,k1);
	sMsg=pinblok(sCardNo,sPIN)+createPadding();
	var encrypted=CryptoJSHSM.AES.encrypt(CryptoJSHSM.enc.Hex.parse(sMsg),k1,{mode:CryptoJSHSM.mode.ECB,padding:CryptoJSHSM.pad.NoPadding});
	return ek1+encrypted.toString().toUpperCase()
}

function encryptPassword(sPKey,sExp,sNoHP,sPassword){
	var k1=CryptoJSHSM.enc.Hex.parse(createKey());
	//var k2=CryptoJSHSM.enc.Hex.parse(createKey());
	var k2=k1;
	var ek1=encryptKey(sPKey,sExp,k1);
	var ek2=encryptKey(sPKey,sExp,k2);
	sMsg=CryptoJSHSM.SHA256(SHA256Pad(sNoHP+sPassword)).toString().toUpperCase();
	var encrypted=CryptoJSHSM.AES.encrypt(CryptoJSHSM.enc.Hex.parse(sMsg),k1,{mode:CryptoJSHSM.mode.ECB,padding:CryptoJSHSM.pad.NoPadding}).toString().toUpperCase();
	var cmac=CryptoJSHSM.CMAC(k2,CryptoJSHSM.enc.Hex.parse(encrypted)).toString().toUpperCase().substring(0,16);
	//sMsg=ek1+ek2+encrypted;
	sMsg=ek1+encrypted;
	sMsg+=cmac;
	return sMsg
}
function a(){encryptKey();encryptMsg();decryptMsg();encryptPIN();encryptPassword()}
function encryptPINChange ( sPKey, sExp, sCardNo, sOldPIN, sNewPIN ) {
	var k1 = CryptoJSHSM.enc.Hex.parse(createKey());

    var ek1 = encryptKey( sPKey, sExp, k1 );

	sMsg = pinblok(sCardNo, sOldPIN) + createPadding();
	
	//console.log("pinblock" + sMsg);
	
    var encryptedO = CryptoJSHSM.AES.encrypt(CryptoJSHSM.enc.Hex.parse(sMsg), k1, { mode: CryptoJSHSM.mode.ECB, padding: CryptoJSHSM.pad.NoPadding });

	sMsg = pinblok(sCardNo, sNewPIN) + createPadding();
	
	//console.log("pinblock" + sMsg);
	
    var encryptedN = CryptoJSHSM.AES.encrypt(CryptoJSHSM.enc.Hex.parse(sMsg), k1, { mode: CryptoJSHSM.mode.ECB, padding: CryptoJSHSM.pad.NoPadding });
    
    return ek1 + encryptedO.toString().toUpperCase() + encryptedN.toString().toUpperCase();
}

function encryptPasswordChange ( sPKey, sExp, sNoHP, sOldPassword, sNewPassword ) {
	var k1 = CryptoJSHSM.enc.Hex.parse(createKey());
	//var k2 = CryptoJSHSM.enc.Hex.parse(createKey());
	var k2 = k1;

    var ek1 = encryptKey( sPKey, sExp, k1 );
    var ek2 = encryptKey( sPKey, sExp, k2 );
    
	sMsg = CryptoJSHSM.SHA256(SHA256Pad(sNoHP + sOldPassword)).toString().toUpperCase();
	
	var encryptedO = CryptoJSHSM.AES.encrypt(CryptoJSHSM.enc.Hex.parse(sMsg), k1, { mode: CryptoJSHSM.mode.ECB, padding: CryptoJSHSM.pad.NoPadding }).toString().toUpperCase();
    
	sMsg = CryptoJSHSM.SHA256(SHA256Pad(sNoHP + sNewPassword)).toString().toUpperCase();
	
	var encryptedN = CryptoJSHSM.AES.encrypt(CryptoJSHSM.enc.Hex.parse(sMsg), k1, { mode: CryptoJSHSM.mode.ECB, padding: CryptoJSHSM.pad.NoPadding }).toString().toUpperCase();

	var cmac = CryptoJSHSM.CMAC(k2, CryptoJSHSM.enc.Hex.parse(encryptedO + encryptedN)).toString().toUpperCase().substring(0, 16);

	//sMsg = ek1 + ek2 + encryptedO + encryptedN;
	sMsg = ek1 + encryptedO + encryptedN;
    
	sMsg += cmac;
	
    return sMsg;
}

function createPaddingCVV() {
    var key = "";
    var data = "0123456789ABCDEF";
    var i;

    for ( i = 0; i < 9; i++ ) {
        key += data[Math.floor((Math.random() * 16))];
    }

    return key;
}

function encryptCVV ( sPKey, sExp, sCardNo, sExpDate, sCVV ) {
	var k1 = createKey();

    var ek1 = encryptKey( sPKey, sExp, CryptoJSHSM.enc.Hex.parse(k1) );

	sMsg = sCardNo + sExpDate + sCVV + createPaddingCVV();
	
	//console.log("pinblock" + sMsg);
	
    var encrypted = encryptMsg(k1, sMsg);

    return ek1 + encrypted;
}

